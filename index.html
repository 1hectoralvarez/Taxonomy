<!DOCTYPE html> 
<html> 
<!-- The following code has been developed by students and/or researchers of the Freshman Research Initiative DIY Diagnostics Stream at The University of Texas at Austin.  This code is shared for demonstration purposes and should not be considered a product -- it is for entertainment purposes only.  Any user of this code does so at their own risk. Members of the DIY Stream, FRI, and The University of Texas system are not liable for anything related to this code.
 
THIS CODE SHOULD NOT BE USED TO DIAGNOSE ANY KIND OF MEDICAL CONDITION.
 
 
Authors in chronological order of contribution:
Tim Riedel
Niam Kuttanna
 
Further Information:
http://diystream.cns.utexas.edu/

Research Educator:
Timothy Riedel
triedel@utexas.edu
 
Brief Description of Goal of Code:
To determine the base composition of a given DNA sequence.
 
Known Issues:
None
-->
   
<!--Header displays app title at the top of the page-->
<head> 
      <title>DNA Sequence Composition Calculator</title>  
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="apple-mobile-web-app-capable" content="yes">
      <link rel="stylesheet" href="w3.css">
      <link rel="stylesheet" href="w3-colors-flat.css">
</head>

	
<!--Script details Javascript functions for storage functions and calculations-->	
<script>
	// Instantiates array containing all base letters in a gene
	var geneArray = [];
	
	// Contains total count of base A occurrences and percent A respectively
	var baseA = 0;
	var percentA = 0;
	
	// Contains total count of base T occurrences and percent T respectively
	var baseT = 0;
	var percentT = 0;
	
	// Contains total count of base G occurrences and percent G respectively
	var baseG = 0;
	var percentG = 0;
	
	// Contains total count of base C occurrences and percent C respectively
	var baseC = 0;
	var percentC = 0;
	
	// Contains total base count
	var baseTotal = 0;
	
	getPageInfo()
	function getPageInfo() {
		var XMLRequest = new XMLHttpRequest();
		XMLRequest.open(GET, "https://www.ncbi.nlm.nih.gov/nuccore/193245035?report=fasta", true);
		XMLRequest.send(null);
		console.log(XMLRequest.responseText);
		if(XMLRequest.status == 200)  
		   return dump(XMLRequest.responseText);
	}
		
		
	
	// Fills the array with the sequence extracted from the specific pre-determined url
	function getArray(page)
	{
		var contentString = 	`ACTGGAAGCACGGCGGCATCGTGGGCGTGCTGGGTTATGGTGGAGGCGTCATCGGCCGCTATTGCGACCG
					GCCGGACCTCTTCCCAGAAGTGGCCCACTTTCACACCATGCGCATCAACCAGCCCTCGAGCAAGTTTTAC
					AATACCGACATCCTGAAAAGACTCCGTGAACTGTGGGAAAGGCGCGGCAGCGGCCTCACCAACATGCATG
					GTTCAACGGGGGACATCATCCTGCTCGGTACCACCACCAATGAACTGGAGCCCATATTCTATGAATTGAC
					CCACGATTTGAATATGGACCTGGGCGGTTCGGGCTCCAACTTGCGCACACCGAGCTGCTGTCTGGGCAAG
					GCCCGTTGCGAGTGGTCCTGCCTTGACACTCAGGCCATCACCAACGACATTACCCATGAGTTCCAGGACG
					AGCCTTATCGACCCGCCTTTCCTTACAAGTTCAAGTTCAAGACCTCCGGCTGCCCCAACGACTGTGTGGC
					CGCCATTGCCCGGGCCGACTGCTCCATCATCGGCACCTGGCGCGATCAGATCCGCATCGACCAGGAGGCT
					GTAAAGGCCTACGCTGCCGGGGAACTGGCCCCCAACGGCAATGCCTTCGATACGGGACCAAGTGCTCTGG
					ACATCCAGAAAGAGGTCTGTGACCTGTGCCCCACCCGTTGCATGGAATGGGACGGCAAGACCCTGAAATC
					TGGGGATGAAGAGTGCAC`;
		var x = 0;
		
		alert(x);
		
		var y = contentString.size();
		
		alert(y);
		
		var textString = contentString.slice(x, y);
				
		for(var i = x; i < y-1; i++)
		{
			geneArray[i] = textString.slice(i, i+1);
		}
	}
	
	// Calculates and returns the percentages and counts of each base in a sequence
	function getComposition()
	{
		// Determines instances of A, T, G, and C in gene and stores to variables
		for(var index = 0; index < geneArray.length; index++)
		{
			if(geneArray[index].equalsIgnoreCase("A"))
			{
				baseA++;
			}
			else if(geneArray[index].equalsIgnoreCase("T"))
			{
				baseT++;
			}
			else if(geneArray[index].equalsIgnoreCase("G"))
			{
				baseG++;
			}
			else
			{
				baseC++;
			}
		}
		
		// Calculates total base count
		baseTotal = baseA + baseT + baseG + baseC;
		
		// Calculates percent composition of each base
		percentA = (baseA / baseTotal) * 100;
		percentT = (baseT / baseTotal) * 100;
		percentG = (baseG / baseTotal) * 100;
		percentC = (baseC / baseTotal) * 100;
		
		// Prints final composition results
		document.getElementById("end").innerHTML = "BASE COMPOSITION: <br>" + "Total Base Count: " + baseTotal + "<br>Adenine Composition: " + percentA + "% - (" + baseA + " occurrences)" + "<br>Thymine Composition: " + percentT + "% - (" + baseT + " occurrences)" + "<br>Guanine Composition: " + percentG + "% - (" + baseG + " occurrences)" + "<br>Cytosine Composition: " + percentC + "% - (" + baseC + " occurrences)";
	}
	
	// Resets all variables to 0 or empty
	function resetVariables()
	{
		geneArray = [];
		baseA = 0;
		baseT = 0;
		baseG = 0;
		baseC = 0;
		percentA = 0;
		percentT = 0;
		percentG = 0;
		percentC = 0;
		baseTotal = 0;
	}
	
</script>
	
	
<!--Allows for multiple mini pages to be displayed within the single overall app, and describes the format.-->	
<style>	
	.body
	{
     		margin: 0em;
	}
	.page
	{
    		width: 100vw;
    		height: 100vh;
    		position: fixed;
    		top: 0;
    		left: -100vw;
    		overflow-y: auto;
    		z-index: 0;
    		background-color: hsl(0,0%,100%);
	}
  	.page:target
	{
    		left: 0vw;
    		z-index: 1;
	}
</style>

	
<!--Describes the content of the pages within the app.-->
<body>
	<div id="header" class="w3-container w3-flat-carrot">
		<h1>DNA Sequence Composition Calculator</h1>
	</div>
		
		<!--This represents the home page and contains a description of the app and its purpose.-->
		<div id="content" class="w3-container">
			<p>This app determines the nitrogenous base composition of the "Uncultured Sulfate-reducing Bacterium Clone GOMGC2B07F DsrA (dsrA)" gene.</p>
	
			<!--The following button takes the user to the start of the process.-->
	
			<a href="#one" class="w3-btn w3-grey w3-round" onclick="getArray('https://www.ncbi.nlm.nih.gov/nuccore/193245035?report=fasta');">Begin</a>
	
			<p>The following code has been developed by students and/or researchers of the Freshman Research Initiative DIY Diagnostics Stream at The University of Texas at 		Austin.  This code is shared for demonstration purposes and should not be considered a product -- it is for entertainment purposes only. Any user of this code 			does so at their own risk. Members of the DIY Stream, FRI, and The University of Texas system are not liable for anything related to this code.</p>
 	
			<p>THIS CODE SHOULD NOT BE USED TO DIAGNOSE ANY KIND OF MEDICAL CONDITION.</p>
			
			
		<!--This represents the first page displaying the URL from which the sequence is obtained-->
			<div class="page" id="one">
	
			<!--First question.-->
				<div id="header" class="w3-container w3-flat-carrot">
					<h1>Source</h1>
				</div>
	
    				<div id="content" class="w3-container">
					<p>The gene sequence was obtained from the following url: </p>
					<a href="https://www.ncbi.nlm.nih.gov/nuccore/193245035?report=fasta">DsrA Gene</a>
        				<p>Continue to results page.</p>  
		
					<!--The following button takes the user to the final page.-->
					
         				<a href="#two"  onclick="getComposition();"	class="w3-btn w3-black">Determine Base Composition</a>
    				</div>
			</div>
		
		<!--This represents the final page, displaying the base composition of the gene.-->
			<div class="page" id="two">
				<div class="w3-container w3-flat-carrot">
					<p id="results"><h1>Results</h1></p>
				</div>
	
				<!--The following segment denotes the final piece of text that contains the respective base percentages and total counts of the gene.-->
					<center>
				<div id="content" class="w3-container">
					<p id='end'>Results would be here</p>	
				</div>
			
				<!--This is where the results chart image will be-->
					<img id="endimg" src="https://i.imgur.com/rZOaHhx.png" alt="spongebob">
				<br>
				<br>
	
				<!--The following button returns the user to the home page and resets the counts.-->
				<a href="#content"  onclick="resetVariables();" class="w3-btn w3-black">Return to Home Page</a>
					</center>
			</div>
			
			
	</div>
</body>
	
</html>
